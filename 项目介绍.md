[toc]

# 项目中遇到的问题

## 视频检测实时性问题

1. 海康网络摄像机工作机制和普通USB摄像头有很大区别，支持的RTSP协议视频流的延迟问题

   解决：


## 系统可用性问题

### PyQt吃掉异常的坑，不输出异常堆栈

PyQt对一个未处理的Python异常会调用一个qFatal函数，底层默认是调用abort终止程序。解决方案就是自己写一个exceptionhook函数，这样就在系统退出之间会被调用，打印出异常堆栈信息。

### PyTorch 显存管理，长时间运行会出现显存溢出

这个问题也是折腾了很久，很长一段时间是无法定位到问题，首先PyTorch内部执行策略是异步调用底层用C++实现的动态链接库来使用显卡，所以报的异常提示定位就不准。

后来通过看各种帖子和Github仓库里的issues，发现需要关掉PyTorch的异步执行机制，但是测试中还是无法重现问题，而且这方面国内的帖子比较少，再者是PyTorch用于项目部署中还是不够很成熟。一个人负责项目心态也很沮丧，又因为项目已经上线测试了一段时间，部门领导经常来检查，经常是我自己去测试的时候都好用，领导一检查就出问题，那段时间在没有找到解决方案甚至都无法定位出问题所在时候，压力特别大。

经过反复的线上测试，和查看了大量的文档和资料，定位到了问题的地方，通过定时清理显存就解决了这个问题。

查找问题和Bug的思路，源头。遇到一个问题提供怎样的解决思路。


数据恢复问题
并发修改一致性问题
数据采集丢失问题

系统框架图
请求处理过程


